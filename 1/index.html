<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QR Translator — Text → QR</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0f172a;--card:#0b1220;--accent:#7c3aed;--muted:#9aa4b2;color-scheme:dark}
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;background:linear-gradient(180deg,#071024 0%,#081426 100%);color:#e6eef6;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
    .container{max-width:900px;width:100%;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03);padding:24px;border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{margin:0 0 18px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:18px}
    textarea{width:100%;min-height:160px;padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;resize:vertical}
    .controls{display:flex;gap:8px;margin-top:10px}
    .btn{background:var(--accent);border:none;color:white;padding:10px 14px;border-radius:8px;cursor:pointer;font-weight:600}
    .btn.secondary{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    .qr-card{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;border-radius:10px;background:rgba(255,255,255,0.01);min-height:320px}
    #qrcode{padding:6px;background:white;border-radius:6px}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    .field-row{display:flex;gap:8px;align-items:center}
    .field-row select,input{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}
    footer{margin-top:16px;color:var(--muted);font-size:13px}
    @media (max-width:880px){.grid{grid-template-columns:1fr;}.qr-card{min-height:220px}}
  </style>
</head>
<body>
  <div class="container">
    <h1>QR Translator — convert text to QR</h1>
    <p class="lead">Type any message below, click <strong>Generate QR</strong>. The other person can scan the QR with their phone camera to read the message.</p>

    <div class="grid">
      <div>
        <label for="text">Message</label>
        <textarea id="text" placeholder="Enter your message here... (URLs, plain text, contact info — anything)" spellcheck="true"></textarea>

        <div style="display:flex;gap:12px;margin-top:10px;align-items:center;flex-wrap:wrap">
          <div style="min-width:160px">
            <label for="size">Size (px)</label>
            <input id="size" type="number" value="280" min="120" max="1200" />
          </div>

          <div style="min-width:160px">
            <label for="ec">Error correction</label>
            <select id="ec">
              <option value="L">L — Low (7%)</option>
              <option value="M" selected>M — Medium (15%)</option>
              <option value="Q">Q — Quartile (25%)</option>
              <option value="H">H — High (30%)</option>
            </select>
          </div>

          <div style="flex:1"></div>

          <div class="controls">
            <button id="generate" class="btn">Generate QR</button>
            <button id="download" class="btn secondary">Download PNG</button>
            <button id="clear" class="btn secondary">Clear</button>
          </div>
        </div>

        <div style="margin-top:12px">
          <label>Decoded preview (what a scanner will show)</label>
          <div id="decoded" style="min-height:44px;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:rgba(255,255,255,0.01);"></div>
        </div>
      </div>

      <div>
        <div class="qr-card">
          <div id="qrcode"></div>
          <div style="margin-top:12px;color:var(--muted);font-size:13px;text-align:center">Scan with your phone camera to view the message. If the scanner opens a link, tap the link; otherwise the text is shown directly.</div>
        </div>
      </div>
    </div>

    <footer>Tip: You can put URLs, short messages, contact cards (vCard) or any text. For very long messages the QR may get dense — try increasing the size or using a URL shortener.</footer>
  </div>

  <!-- QRCode.js library (small, client-side) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    const textEl = document.getElementById('text');
    const qrcodeEl = document.getElementById('qrcode');
    const decodedEl = document.getElementById('decoded');
    const sizeEl = document.getElementById('size');
    const ecEl = document.getElementById('ec');
    const generateBtn = document.getElementById('generate');
    const downloadBtn = document.getElementById('download');
    const clearBtn = document.getElementById('clear');

    let qr; // QRCode instance

    function generate() {
      const text = textEl.value.trim();
      const size = parseInt(sizeEl.value, 10) || 280;
      const ec = ecEl.value || 'M';

      if (!text) {
        alert('Please enter a message to encode.');
        return;
      }

      // clear previous
      qrcodeEl.innerHTML = '';

      // QRCode.js accepts 'correctLevel' as an object on creation, map letter -> constant
      const ecMap = { L: QRCode.CorrectLevel.L, M: QRCode.CorrectLevel.M, Q: QRCode.CorrectLevel.Q, H: QRCode.CorrectLevel.H };

      qr = new QRCode(qrcodeEl, {
        text,
        width: size,
        height: size,
        correctLevel: ecMap[ec]
      });

      // show decoded preview (what scanner will reveal)
      decodedEl.textContent = text;
    }

    generateBtn.addEventListener('click', generate);

    clearBtn.addEventListener('click', () => {
      textEl.value = '';
      qrcodeEl.innerHTML = '';
      decodedEl.textContent = '';
    });

    downloadBtn.addEventListener('click', () => {
      if (!qrcodeEl.firstChild) { alert('Generate a QR first'); return; }

      // QRCode.js may render an <img> or a <canvas>. Handle both.
      const node = qrcodeEl.querySelector('img') || qrcodeEl.querySelector('canvas');
      if (!node) { alert('No QR found'); return; }

      if (node.tagName.toLowerCase() === 'img') {
        // img has src data URL
        const src = node.src;
        const a = document.createElement('a');
        a.href = src;
        a.download = 'qr.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
      } else {
        // canvas -> toDataURL
        const dataURL = node.toDataURL('image/png');
        const a = document.createElement('a');
        a.href = dataURL;
        a.download = 'qr.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
      }
    });

    // Optional: generate a sample QR on load
    window.addEventListener('load', () => {
      textEl.value = 'Hello — scan this QR to see a message!';
      generate();
    });
  </script>
</body>
</html>
